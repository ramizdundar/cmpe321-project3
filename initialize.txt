CREATE DATABASE IF NOT EXISTS cmpe321;

USE cmpe321;

DELIMITER //

CREATE PROCEDURE startup()
BEGIN
    CREATE TABLE IF NOT EXISTS books (isbn INT PRIMARY KEY, title VARCHAR(255), author VARCHAR(255), borrowed BOOLEAN);
    CREATE TABLE IF NOT EXISTS borrows (tc INT, isbn INT, date VARCHAR(255));
    DROP TRIGGER IF EXISTS tr_borrow;
END //

DELIMITER ;

CALL startup;

CREATE TRIGGER tr_borrow BEFORE INSERT ON borrows FOR EACH ROW UPDATE books SET borrowed = 1 WHERE isbn = NEW.isbn;
